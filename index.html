<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>å¿«æ¨‚èŠ’æœï¼šå¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨ PWA</title>

  <!-- PWA Meta Tags -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <meta name="apple-mobile-web-app-title" content="å¿«æ¨‚èŠ’æœ" />
  <meta name="theme-color" content="#fbbf24" />

  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" />

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');

    :root{
      --indigo: #312e81;
      --orange: #f59e0b;
      --orange2: #fbbf24;
      --bg: #fffbeb;
    }

    body {
      font-family: 'Noto Sans TC', sans-serif;
      background-color: var(--bg);
      -webkit-tap-highlight-color: transparent;
      color: var(--indigo);
    }

    .mango-gradient { background: linear-gradient(135deg, var(--orange2) 0%, var(--orange) 100%); }
    .glass-card { background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); border: 1px solid rgba(251, 191, 36, 0.2); }
    .tab-active { color: var(--orange); border-bottom: 3px solid var(--orange); }

    .page-content { display: none; }
    .page-content.active { display: block; }

    .fade-in { animation: fadeIn 0.35s ease-out forwards; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

    /* æ»¾å‹•æ¢ç¾åŒ– */
    ::-webkit-scrollbar { width: 4px; }
    ::-webkit-scrollbar-thumb { background: #fde68a; border-radius: 10px; }

    /* æ¸›å°‘æšˆçœ©ï¼šå°Šé‡ä½¿ç”¨è€…æ¸›å°‘å‹•ç•«åå¥½ */
    @media (prefers-reduced-motion: reduce) {
      .fade-in { animation: none !important; }
      * { scroll-behavior: auto !important; }
    }
  </style>
</head>

<body class="pb-24">
  <!-- Header å°è¦½æ¬„ -->
  <header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md px-4 py-3 flex items-center justify-between shadow-sm">
    <div class="flex items-center space-x-2">
      <div class="w-10 h-10 mango-gradient rounded-xl flex items-center justify-center text-white text-xl shadow-lg" aria-hidden="true">
        <i class="fas fa-hand-holding-heart"></i>
      </div>
      <div>
        <h1 class="text-lg font-black tracking-tight text-indigo-900">å¿«æ¨‚èŠ’æœ</h1>
        <p class="text-[9px] text-orange-500 font-black uppercase tracking-tighter">å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨</p>
      </div>
    </div>

    <button
      data-page="sos"
      class="bg-red-500 text-white px-3 py-1.5 rounded-full shadow-lg flex items-center space-x-1 active:scale-90 transition-all"
      aria-label="å•Ÿå‹•æƒ…ç·’æ€¥æ•‘"
    >
      <i class="fas fa-bolt text-xs" aria-hidden="true"></i>
      <span class="text-[11px] font-black">æƒ…ç·’æ€¥æ•‘</span>
    </button>
  </header>

  <!-- ä¸»å…§å®¹å€ -->
  <main class="max-w-md mx-auto p-5">
    <!-- 1. é¦–é  -->
    <div id="page-home" class="page-content active space-y-8">
      <section class="space-y-4">
        <div class="flex items-center space-x-2 px-1">
          <div class="bg-yellow-400 w-1.5 h-5 rounded-full" aria-hidden="true"></div>
          <h2 class="text-md font-bold text-indigo-900">å¹¸ç¦æ™ºå¤šæ˜Ÿ</h2>
        </div>

        <div class="glass-card p-5 rounded-[2rem] shadow-xl border-orange-100">
          <p class="text-xs text-indigo-700 mb-4 font-medium">é‡åˆ°äº†ä»€éº¼å›°é›£ï¼Ÿç¬‘é•·é™ªä½ æ‰¾å°ç­–ï¼š</p>

          <div class="relative">
            <label class="sr-only" for="queryInput">è¼¸å…¥å•é¡Œ</label>
            <input
              type="text"
              id="queryInput"
              placeholder="å­©å­ä¸å°ˆå¿ƒã€è¢«æ‰“çš„èŠ’æœã€æ§åˆ¶ä¸ä½æƒ…ç·’..."
              autocomplete="off"
              class="w-full bg-orange-50/50 border-2 border-orange-100 rounded-2xl px-4 py-3.5 focus:outline-none focus:border-orange-400 transition-all text-indigo-900 text-sm font-medium pr-24"
            />

            <div class="absolute right-1.5 top-1.5 flex gap-2">
              <button
                id="btnSearch"
                class="mango-gradient text-white w-10 h-10 rounded-xl shadow-md flex items-center justify-center active:scale-95 transition"
                aria-label="æœå°‹"
              >
                <i class="fas fa-search text-sm" aria-hidden="true"></i>
              </button>

              <button
                id="btnClear"
                class="bg-white border border-orange-100 text-orange-600 w-10 h-10 rounded-xl shadow-sm flex items-center justify-center active:scale-95 transition"
                aria-label="æ¸…é™¤"
                title="æ¸…é™¤"
              >
                <i class="fas fa-xmark text-sm" aria-hidden="true"></i>
              </button>
            </div>
          </div>

          <div id="mastermindResult" class="mt-4 hidden" aria-live="polite"></div>
        </div>
      </section>

      <!-- å››é‡å¥å…¥å£ -->
      <section class="grid grid-cols-2 gap-3">
        <button data-method="see" class="glass-card p-4 rounded-[1.8rem] text-left active:scale-[0.99] transition">
          <div class="w-9 h-9 bg-blue-100 text-blue-500 rounded-xl flex items-center justify-center mb-2" aria-hidden="true">
            <i class="fas fa-eye text-sm"></i>
          </div>
          <p class="font-bold text-indigo-900 text-sm">çœ‹</p>
        </button>

        <button data-method="say" class="glass-card p-4 rounded-[1.8rem] text-left active:scale-[0.99] transition">
          <div class="w-9 h-9 bg-green-100 text-green-500 rounded-xl flex items-center justify-center mb-2" aria-hidden="true">
            <i class="fas fa-comment text-sm"></i>
          </div>
          <p class="font-bold text-indigo-900 text-sm">èªª</p>
        </button>

        <button data-method="play" class="glass-card p-4 rounded-[1.8rem] text-left active:scale-[0.99] transition">
          <div class="w-9 h-9 bg-purple-100 text-purple-500 rounded-xl flex items-center justify-center mb-2" aria-hidden="true">
            <i class="fas fa-gamepad text-sm"></i>
          </div>
          <p class="font-bold text-indigo-900 text-sm">ç©</p>
        </button>

        <button data-method="use" class="glass-card p-4 rounded-[1.8rem] text-left active:scale-[0.99] transition">
          <div class="w-9 h-9 bg-orange-100 text-orange-500 rounded-xl flex items-center justify-center mb-2" aria-hidden="true">
            <i class="fas fa-utensils text-sm"></i>
          </div>
          <p class="font-bold text-indigo-900 text-sm">ç”¨</p>
        </button>
      </section>

      <section class="mango-gradient p-7 rounded-[2.5rem] text-white shadow-2xl">
        <h3 class="text-xl font-black mb-4 tracking-tight">èŠ’æœå’Œå¹³æ¢ç´„</h3>
        <div class="space-y-3 mb-6 text-[12px] font-bold">
          <p><i class="fas fa-heart mr-2 text-[10px]" aria-hidden="true"></i> æˆ‘å€‘ä¸æ‰“äººï¼Œä¹Ÿä¸æ‰“æ°´æœã€‚</p>
          <p><i class="fas fa-cloud mr-2 text-[10px]" aria-hidden="true"></i> æ„Ÿè¦ºçˆ†ç‚¸æ™‚ï¼Œæˆ‘å€‘ä¸€èµ·å¤§å‘¼å¸ã€‚</p>
        </div>
        <button data-page="repair" class="w-full bg-white text-orange-600 py-3 rounded-2xl font-black text-sm active:scale-95 transition">
          ä¿®å¾©å‰›æ‰çš„ã€Œä¸å°å¿ƒã€
        </button>
      </section>
    </div>

    <!-- 2. å½±ç‰‡åˆ†é  -->
    <div id="page-video" class="page-content space-y-6">
      <div class="flex items-center space-x-2 px-1">
        <div class="bg-indigo-600 w-1.5 h-5 rounded-full" aria-hidden="true"></div>
        <h2 class="text-md font-bold text-indigo-900">ç¬‘é•·æ™ºæ…§å½±ç‰‡é¤¨</h2>
      </div>

      <div class="glass-card overflow-hidden rounded-[2.5rem] shadow-lg border-2 border-orange-50">
        <div class="aspect-video w-full bg-black">
          <iframe
            class="w-full h-full"
            loading="lazy"
            src="https://www.youtube.com/embed/p1WXzRhoUjg"
            title="è¢«æ‰“çš„èŠ’æœï¼š90 ç§’æ•‘å›å°ˆæ³¨åŠ›"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
          ></iframe>
        </div>

        <div class="p-6 space-y-3">
          <div class="flex justify-between items-start gap-3">
            <h3 class="font-black text-indigo-900 text-lg leading-tight">ï¼œè¢«æ‰“çš„èŠ’æœï¼<br />90 ç§’æ•‘å›å°ˆæ³¨åŠ›</h3>
            <span class="shrink-0 bg-orange-100 text-orange-600 text-[10px] px-2 py-1 rounded-full font-bold italic">è…¦ç§‘å­¸ç¯‡</span>
          </div>

          <p class="text-[12px] text-indigo-700 leading-relaxed font-medium">
            å­©å­ä¸æ˜¯ä¸å°ˆå¿ƒï¼Œæ˜¯å‰é¡è‘‰è¢«å£“ä½äº†ã€‚é€™é›†ç”±ã€Œå¹¸ç¦å§‘ã€ç¬‘é•·è¦ªè‡ªè§£æã€Œæä»æ ¸è­¦å ±ã€å¦‚ä½•å½±éŸ¿å­¸ç¿’ï¼Œä¸¦æ•™æ‚¨å¦‚ä½•ç”¨ 90 ç§’å®Œæˆæ€¥æ•‘ã€‚
          </p>

          <div class="flex gap-2 pt-2 flex-wrap">
            <span class="text-[10px] bg-red-50 text-red-500 px-3 py-1 rounded-lg font-bold border border-red-100">ä¸è¦æ‰“èŠ’æœ</span>
            <span class="text-[10px] bg-indigo-50 text-indigo-500 px-3 py-1 rounded-lg font-bold border border-indigo-100">æ•™é¤Šæ­£èƒ½é‡</span>
          </div>
        </div>
      </div>

      <!-- æ¦‚å¿µé¤¨å…¥å£ -->
      <div class="bg-white p-6 rounded-[2.5rem] border-2 border-indigo-100 text-center space-y-4 shadow-sm">
        <div class="w-16 h-16 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mx-auto text-3xl" aria-hidden="true">
          <i class="fas fa-university"></i>
        </div>

        <h3 class="font-black text-indigo-900">å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨</h3>
        <p class="text-[11px] text-indigo-600 font-medium px-4 leading-relaxed">
          æƒ³çœ‹æ›´å¤šç¬‘é•·çš„ç³»çµ±åŒ–æ•™å­¸å—ï¼ŸåŒ…å«å¿ƒéˆæ„Ÿæ‚Ÿèˆ‡è…¦ç¥ç¶“ç§‘å­¸åŸç¨¿ï¼Œç›¡åœ¨æ¦‚å¿µé¤¨å®˜ç¶²ã€‚
        </p>

        <button
          id="btnOpenHome"
          class="w-full bg-indigo-600 text-white py-3.5 rounded-2xl font-black text-sm shadow-md flex items-center justify-center active:scale-95 transition"
        >
          <i class="fas fa-external-link-alt mr-2 text-xs" aria-hidden="true"></i> é€²å…¥æ¦‚å¿µé¤¨å®˜ç¶²
        </button>
      </div>
    </div>

    <!-- 3. ä¿®å¾©èˆ‡å›é¥‹ -->
    <div id="page-repair" class="page-content space-y-6">
      <div class="flex items-center space-x-2 px-1">
        <div class="bg-orange-400 w-1.5 h-5 rounded-full" aria-hidden="true"></div>
        <h2 class="text-md font-bold text-indigo-900">é—œä¿‚ä¿®å¾©èˆ‡å›é¥‹</h2>
      </div>

      <div class="bg-white p-7 rounded-[2.5rem] border-2 border-orange-100 space-y-5">
        <h3 class="font-black text-indigo-900 text-center text-lg underline decoration-orange-300 decoration-4 underline-offset-4">
          ä¿®å¾©é—œä¿‚å››éƒ¨æ›²
        </h3>

        <div class="space-y-3">
          <div class="p-3.5 bg-orange-50/50 rounded-2xl border-l-4 border-orange-400">
            <p class="text-sm font-medium"><span class="font-black text-orange-600">Step 1. æ‰¿èªï¼š</span>ã€Œå‰›æ‰æˆ‘å¤ªæ€¥äº†ï¼Œå°ä¸èµ·ã€‚ã€</p>
          </div>
          <div class="p-3.5 bg-orange-50/50 rounded-2xl border-l-4 border-orange-400">
            <p class="text-sm font-medium"><span class="font-black text-orange-600">Step 2. å‘½åï¼š</span>ã€Œä½ å‰›æ‰å¾ˆå®³æ€•ã€å¾ˆé›£éå°å—ï¼Ÿã€</p>
          </div>
          <div class="p-3.5 bg-orange-50/50 rounded-2xl border-l-4 border-orange-400">
            <p class="text-sm font-medium"><span class="font-black text-orange-600">Step 3. ä¿è­‰ï¼š</span>ã€Œæˆ‘æœƒä¿è­·ä½ ï¼Œæˆ‘å€‘ä¸æ‰“äººã€‚ã€</p>
          </div>
          <div class="p-3.5 bg-orange-50/50 rounded-2xl border-l-4 border-orange-400">
            <p class="text-sm font-medium"><span class="font-black text-orange-600">Step 4. é‡æ¼”ï¼š</span>ã€Œæˆ‘å€‘å‘¼å¸ä¸‰æ¬¡ï¼Œé‡æ–°é–‹å§‹ã€‚ã€</p>
          </div>
        </div>
      </div>

      <!-- Google è¡¨å–®å›é¥‹ -->
      <div class="mango-gradient p-8 rounded-[3rem] text-white text-center space-y-4 shadow-2xl relative overflow-hidden">
        <div class="absolute -top-4 -right-4 w-24 h-24 bg-white/10 rounded-full" aria-hidden="true"></div>
        <i class="fas fa-clipboard-check text-4xl" aria-hidden="true"></i>

        <h3 class="font-black text-xl">App å„ªåŒ–å›é¥‹è¡¨å–®</h3>
        <p class="text-[12px] font-bold opacity-90 px-2 leading-relaxed">
          è¦ªæ„›çš„å®¶é•·ï¼Œæ‚¨çš„å¯¦è¸å¿ƒå¾—æ˜¯ç¬‘é•·æœ€çè²´çš„ç¦®ç‰©ï¼è«‹åˆ†äº«æ‚¨çš„å»ºè­°ï¼Œè®“æˆ‘å€‘ä¸€èµ·å„ªåŒ–å·¥å…·ã€‚
        </p>

        <button
          id="btnOpenForm"
          class="w-full bg-indigo-900 text-white py-4 rounded-[1.5rem] font-black text-sm shadow-xl active:scale-95 transition-all"
        >
          å¡«å¯«å„ªåŒ–å·¥å…·å›é¥‹å–®
        </button>

        <p class="text-[10px] opacity-90 font-bold">
          â€» è¨˜å¾—æŠŠ <span class="underline">your_form_id</span> æ›æˆä½ çš„ Google è¡¨å–®é€£çµ
        </p>
      </div>
    </div>

    <!-- 4. SOS -->
    <div id="page-sos" class="page-content space-y-4">
      <div class="bg-red-50 p-7 rounded-[2.5rem] border-2 border-red-100 shadow-2xl">
        <div class="flex justify-between items-center mb-6">
          <h3 class="font-black text-red-600 flex items-center">
            <i class="fas fa-lungs mr-3 text-xl" aria-hidden="true"></i> æƒ…ç·’æ€¥æ•‘ï¼šåœçœ‹å‘¼åæ›å‹•
          </h3>
          <button data-page="home" class="text-red-300" aria-label="é—œé–‰æ€¥æ•‘">
            <i class="fas fa-times-circle text-2xl" aria-hidden="true"></i>
          </button>
        </div>

        <div id="sosSteps" class="space-y-3"></div>

        <button id="sosBtn" class="w-full mt-8 bg-red-500 text-white py-4 rounded-2xl font-black text-sm shadow-lg active:scale-95 transition">
          å¥½ï¼Œä¸‹ä¸€å°æ­¥
        </button>
      </div>
    </div>
  </main>

  <!-- Footer Tab Bar -->
  <nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t border-orange-100 flex justify-around items-center py-4 z-50 rounded-t-[2rem] shadow-[0_-5px_20px_rgba(0,0,0,0.05)]">
    <button data-page="home" id="tab-home" class="flex flex-col items-center tab-active transition-all">
      <i class="fas fa-home text-lg" aria-hidden="true"></i>
      <span class="text-[10px] font-black mt-1">é™ªä¼´é¦–é </span>
    </button>

    <button data-page="video" id="tab-video" class="flex flex-col items-center text-indigo-300 transition-all">
      <i class="fas fa-play-circle text-lg" aria-hidden="true"></i>
      <span class="text-[10px] font-black mt-1">æ™ºæ…§å½±ç‰‡</span>
    </button>

    <button id="tab-concept" class="flex flex-col items-center text-indigo-300 transition-all" aria-label="é–‹å•Ÿæ¦‚å¿µé¤¨å®˜ç¶²">
      <i class="fas fa-university text-lg" aria-hidden="true"></i>
      <span class="text-[10px] font-black mt-1">æ¦‚å¿µé¤¨å®˜ç¶²</span>
    </button>

    <button data-page="repair" id="tab-repair" class="flex flex-col items-center text-indigo-300 transition-all">
      <i class="fas fa-edit text-lg" aria-hidden="true"></i>
      <span class="text-[10px] font-black mt-1">å›é¥‹å„ªåŒ–</span>
    </button>
  </nav>

  <!-- Global Modal -->
  <div id="globalModal" class="fixed inset-0 bg-indigo-900/60 backdrop-blur-md z-[100] hidden items-center justify-center p-6" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
    <div class="bg-white rounded-[2.5rem] p-8 w-full max-w-sm shadow-2xl fade-in" onclick="event.stopPropagation()">
      <div id="modalHeader" class="flex justify-between items-start mb-6">
        <div id="modalIcon" class="w-16 h-16 rounded-2xl flex items-center justify-center text-3xl" aria-hidden="true"></div>
        <button id="btnCloseModal" class="text-indigo-100" aria-label="é—œé–‰æç¤º">
          <i class="fas fa-times-circle text-2xl" aria-hidden="true"></i>
        </button>
      </div>

      <h3 id="modalTitle" class="text-2xl font-black text-indigo-900 mb-1 tracking-tight"></h3>
      <p id="modalSub" class="text-orange-500 text-[12px] font-black mb-5 uppercase tracking-widest"></p>
      <p id="modalDesc" class="text-indigo-800 text-sm leading-relaxed font-medium mb-10"></p>

      <button id="btnModalOk" class="w-full mango-gradient text-white py-4 rounded-2xl font-black text-sm shadow-lg active:scale-95 transition">
        å¥½ï¼Œé™ªå­©å­è©¦è©¦
      </button>
    </div>
  </div>

  <script>
    // ========= åŸºæœ¬è¨­å®š =========
    const LINKS = {
      concept: "https://angel0973180707.github.io/angel-happy-paw/",
      form: "https://forms.gle/your_form_id"
    };

    const $ = (sel, root = document) => root.querySelector(sel);
    const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

    const pages = ["home", "video", "repair", "sos"];
    let currentPage = "home";

    // ========= å°é ï¼ˆçµ±ä¸€ç®¡ç†ï¼‰ =========
    function showPage(pageId) {
      if (!pages.includes(pageId)) return;

      // page
      $$(".page-content").forEach(p => p.classList.remove("active"));
      $("#page-" + pageId).classList.add("active");

      // tabï¼ˆconcept æ²’æœ‰ activeï¼‰
      $$("#tab-home, #tab-video, #tab-repair").forEach(tab => {
        tab.classList.remove("tab-active");
        tab.classList.add("text-indigo-300");
      });

      const activeTab = $("#tab-" + (pageId === "sos" ? "home" : pageId));
      if (activeTab) {
        activeTab.classList.add("tab-active");
        activeTab.classList.remove("text-indigo-300");
      }

      currentPage = pageId;
      if (pageId === "sos") startSOS();
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // ========= å¹¸ç¦æ™ºå¤šæ˜Ÿï¼ˆæ›´ç©©çš„åŒ¹é…ï¼‰ =========
    function normalizeQuery(q) {
      return (q || "")
        .toString()
        .trim()
        .replace(/\s+/g, " ");
    }

    function hasAny(text, keywords) {
      return keywords.some(k => text.includes(k));
    }

    // ä½ ä¹‹å¾Œè¦æ“´å……ï¼Œåªè¦å¾€é€™è£¡åŠ è¦å‰‡å³å¯
    const mastermindRules = [
      {
        id: "mango_focus",
        keywords: ["èŠ’æœ", "ä¸å°ˆå¿ƒ", "æ‰“", "è¢«æ‰“", "å°ˆæ³¨"],
        render: () => `
          <div class="bg-red-50 p-5 rounded-2xl border-l-4 border-red-400 fade-in">
            <p class="text-indigo-900 font-black text-md mb-2 flex items-center">
              <i class="fas fa-video mr-2 text-red-400" aria-hidden="true"></i> åŒ¹é…å½±ç‰‡ï¼šè¢«æ‰“çš„èŠ’æœ
            </p>
            <p class="text-[12px] text-indigo-700 font-medium mb-4 leading-relaxed">
              ç¬‘é•·æé†’ä½ ï¼šå­©å­é€™æ™‚å€™å¾ˆå¯èƒ½æ˜¯ã€Œå‰é¡è‘‰æ‹”é›»ã€äº†ï¼å¼·è¿«åªæœƒè®“ã€Œæä»æ ¸ã€æ›´ç·Šå¼µã€‚
              å…ˆé™æº«ï¼Œå†å›åˆ°ä»»å‹™ã€‚
            </p>
            <div class="flex space-x-2">
              <button data-page="video" class="bg-indigo-900 text-white px-4 py-2 rounded-xl text-[11px] font-black shadow-md active:scale-95 transition">ç«‹å³è§€çœ‹å½±ç‰‡</button>
              <button data-page="sos" class="bg-red-500 text-white px-4 py-2 rounded-xl text-[11px] font-black shadow-md active:scale-95 transition">å•Ÿå‹• SOS æ€¥æ•‘</button>
            </div>
          </div>`
      }
    ];

    function renderResultHTML(html) {
      const res = $("#mastermindResult");
      res.classList.remove("hidden");
      res.innerHTML = html;
    }

    function hideResult() {
      const res = $("#mastermindResult");
      res.classList.add("hidden");
      res.innerHTML = "";
    }

    function happinessMastermind() {
      const input = normalizeQuery($("#queryInput").value);
      if (!input) {
        hideResult();
        return;
      }

      // æ‰¾ç¬¬ä¸€å€‹ç¬¦åˆçš„è¦å‰‡
      const matched = mastermindRules.find(rule => hasAny(input, rule.keywords));

      if (matched) {
        renderResultHTML(matched.render());
        return;
      }

      renderResultHTML(`
        <div class="bg-indigo-50 p-5 rounded-2xl border-l-4 border-indigo-400 fade-in">
          <p class="text-indigo-900 font-black text-md mb-2 tracking-tight">ğŸ’¡ ç¬‘é•·çš„æ™ºæ…§å¼•å°</p>
          <p class="text-[12px] text-indigo-700 font-medium mb-3">
            å…ˆè©¦è©¦ç”¨ã€Œæˆ‘çœ‹åˆ°ä½ â€¦ã€ä¾†å°é½Šå­©å­çš„ç‹€æ…‹ï¼ˆå…ˆé€£çµã€å†å¼•å°ï¼‰ã€‚
            å¦‚æœä½ æƒ³æ‰¾æ›´å®Œæ•´çš„å¿ƒè…¦ç§‘å­¸èˆ‡ç³»çµ±èª²ï¼Œæ­¡è¿å»æ¦‚å¿µé¤¨ã€‚
          </p>
          <button id="btnGoConceptInline" class="text-indigo-600 font-black underline text-xs active:opacity-80">å‰å¾€å¹¸ç¦æ•™é¤Šæ¦‚å¿µé¤¨å®˜ç¶²</button>
        </div>
      `);

      // å‹•æ…‹ç¶å®šï¼ˆå› ç‚ºå‰›æ’å…¥ DOMï¼‰
      const inlineBtn = $("#btnGoConceptInline");
      if (inlineBtn) inlineBtn.addEventListener("click", () => window.open(LINKS.concept, "_blank"));
    }

    // ========= SOS æ€¥æ•‘ =========
    let currentStep = 0;
    const steps = [
      "åœï¼šå…ˆåœä¸‹è¿½å•ï¼ŒéŸ³é‡é™ä¸€åŠ",
      "çœ‹ï¼šçœ‹çœ‹å­©å­çš„è¨Šè™Ÿï¼Œä¹Ÿçœ‹çœ‹è‡ªå·±",
      "å‘¼ï¼šä¸€èµ·å‘¼å¸ï¼ˆå¸4ã€åœ2ã€å6ï¼‰",
      "åï¼šå¹«æƒ…ç·’å‘½åï¼ŒåŒç†å­©å­",
      "æ›ï¼šæŠŠä»»å‹™ç¸®å°ï¼Œå…ˆè©¦ç™¼ä¸€å€‹éŸ³",
      "å‹•ï¼šæ“ŠæŒã€å¼µå¤§å˜´ï¼Œè®“èº«é«”å‹•èµ·ä¾†"
    ];

    function startSOS() {
      currentStep = 0;
      updateSOSUI();
    }

    function nextSOSStep() {
      if (currentStep < steps.length - 1) {
        currentStep++;
        updateSOSUI();
      } else {
        showPage("home");
      }
    }

    function updateSOSUI() {
      const container = $("#sosSteps");
      container.innerHTML = "";

      for (let i = 0; i <= currentStep; i++) {
        const div = document.createElement("div");
        div.className = "p-4 bg-white rounded-2xl shadow-sm border-l-4 border-red-500 text-[13px] font-bold text-indigo-900 fade-in";
        div.innerHTML = `<span class="text-red-500 mr-2">${i + 1}.</span> ${steps[i]}`;
        container.appendChild(div);
      }

      $("#sosBtn").innerText = currentStep === steps.length - 1 ? "æ€¥æ•‘å®Œæˆï¼Œæ‰¾å›é€£çµ" : "ä¸‹ä¸€å°æ­¥";
    }

    // ========= Modalï¼ˆå››é‡å¥ï¼‰ =========
    const methodMap = {
      see:  { title: "çœ‹", sub: "è§€å¯Ÿä¸è©•åƒ¹", desc: "é»˜æ•¸åç§’ï¼Œåªçœ‹å­©å­ç‰¹å¾µã€‚", color: "blue", icon: "fa-eye" },
      say:  { title: "èªª", sub: "å¡‘å½¢å°æ­¥èµ°", desc: "å­©å­ç™¼å‡ºä¸€å€‹éŸ³ï¼Œå°±æ˜¯å·¨å¤§é€²æ­¥ï¼", color: "green", icon: "fa-comment" },
      play: { title: "ç©", sub: "å›åˆè®Šæ›", desc: "äº”åˆ†é˜ä¸€å›åˆï¼Œå¡é—œå°±ç©éŠæˆ²ã€‚", color: "purple", icon: "fa-gamepad" },
      use:  { title: "ç”¨", sub: "ç”Ÿæ´»å¯¦è¸", desc: "å»å¸‚å ´èé¦™æ°£ï¼Œé€£çµç¾å¯¦ç”Ÿæ´»ã€‚", color: "orange", icon: "fa-utensils" }
    };

    function openMethod(key) {
      const data = methodMap[key];
      if (!data) return;

      const colors = {
        blue: "bg-blue-100 text-blue-500",
        green: "bg-green-100 text-green-500",
        purple: "bg-purple-100 text-purple-500",
        orange: "bg-orange-100 text-orange-500"
      };

      $("#modalIcon").className = `w-16 h-16 rounded-2xl flex items-center justify-center text-3xl ${colors[data.color]}`;
      $("#modalIcon").innerHTML = `<i class="fas ${data.icon}" aria-hidden="true"></i>`;
      $("#modalTitle").innerText = data.title;
      $("#modalSub").innerText = data.sub;
      $("#modalDesc").innerText = data.desc;

      $("#globalModal").classList.remove("hidden");
      $("#globalModal").classList.add("flex");
    }

    function closeModal() {
      $("#globalModal").classList.add("hidden");
      $("#globalModal").classList.remove("flex");
    }

    // ========= åˆå§‹åŒ– & äº‹ä»¶ç¶å®š =========
    document.addEventListener("click", (e) => {
      // data-page å°é 
      const pageBtn = e.target.closest("[data-page]");
      if (pageBtn) {
        const page = pageBtn.getAttribute("data-page");
        showPage(page);
        return;
      }

      // å››é‡å¥
      const methodBtn = e.target.closest("[data-method]");
      if (methodBtn) {
        openMethod(methodBtn.getAttribute("
